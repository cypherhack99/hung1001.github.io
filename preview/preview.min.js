var HTMLPreview={content:"",previewform:document.getElementById("previewform"),file:function(){var e=decodeURIComponent(location.search.substring(1));if(-1!=e.indexOf("&"))var r=e.split("&")[0];else r=e;return r},raw:function(){return HTMLPreview.file().replace(/\/\/github\.com/,"//raw.githubusercontent.com").replace(/\/blob\//,"/")},replaceAssets:function(){var e,r,t,o,s,n,i;for(e=document.querySelectorAll("iframe[src],frame[src]"),s=0;s<e.length;++s)((i=e[s].src).indexOf("//raw.githubusercontent.com")>0||i.indexOf("//bitbucket.org")>0)&&(e[s].src="//"+location.hostname+location.pathname+"?"+i);for(r=document.querySelectorAll("a[href]"),s=0;s<r.length;++s)(n=r[s].href).indexOf("#")>0?r[s].href="//"+location.hostname+location.pathname+location.search+"#"+r[s].hash.substring(1):(n.indexOf("//raw.githubusercontent.com")>0||n.indexOf("//bitbucket.org")>0)&&(n.indexOf(".html")>0||n.indexOf(".htm")>0)&&(r[s].href="//"+location.hostname+location.pathname+"?"+n);if(!document.querySelectorAll("frameset").length){for(t=document.querySelectorAll("link[rel=stylesheet]"),s=0;s<t.length;++s)((n=t[s].href).indexOf("//raw.githubusercontent.com")>0||n.indexOf("//bitbucket.org")>0)&&HTMLPreview.send(n,"loadCSS");for(o=document.querySelectorAll('script[type="text/htmlpreview"]'),s=0;s<o.length;++s)(i=o[s].src).indexOf("//raw.githubusercontent.com")>0||i.indexOf("//bitbucket.org")>0?HTMLPreview.send(i,"loadJS"):(o[s].removeAttribute("type"),document.write(o[s].outerHTML))}},loadHTML:function(e){e&&e.query&&e.query.results&&e.query.results.resources&&e.query.results.resources.content&&200==e.query.results.resources.status?(HTMLPreview.content=e.query.results.resources.content.replace(/<head>/i,'<head><base href="'+HTMLPreview.raw()+'">').replace(/<script( type=["'](text|application)\/javascript["'])?/gi,'<script type="text/htmlpreview"').replace(/<\/body>/i,'<script src="//'+location.hostname+'/preview/preview.min.js"><\/script><script>HTMLPreview.replaceAssets();<\/script></body>').replace(/<\/head>\s*<frameset/gi,'<script src="//'+location.hostname+'/preview/preview.min.js"><\/script><script>document.addEventListener("DOMContentLoaded",HTMLPreview.replaceAssets,false);<\/script></head><frameset'),setTimeout(function(){document.open(),document.write(HTMLPreview.content),document.close()},50)):e&&e.error&&e.error.description?HTMLPreview.previewform.innerHTML=e.error.description:HTMLPreview.previewform.innerHTML="Error: Cannot load file "+HTMLPreview.raw()},loadCSS:function(e){e&&e.query&&e.query.results&&e.query.results.resources&&e.query.results.resources.content&&200==e.query.results.resources.status&&document.write("<style>"+e.query.results.resources.content.replace(/url\((?:'|")?([^\/][^:'"\)]+)(?:'|")?\)/gi,"url("+e.query.results.resources.url.replace(/[^\/]+\.css.*$/gi,"")+"$1)")+"</style>")},loadJS:function(e){e&&e.query&&e.query.results&&e.query.results.resources&&e.query.results.resources.content&&200==e.query.results.resources.status&&document.write("<script>"+e.query.results.resources.content+"<\/script>")},send:function(e,r){document.write('<script src="//query.yahooapis.com/v1/public/yql?q=select%20*%20from%20data.headers%20where%20url%3D%22'+encodeURIComponent(e)+"%22&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&diagnostics=true&callback=HTMLPreview."+r+'"><\/script>')},submitform:function(){return window.open(location.href.split("?")[0]+"?"+decodeURIComponent(document.getElementById("file").value),"_blank"),!1},init:function(){HTMLPreview.previewform.onsubmit=HTMLPreview.submitform,HTMLPreview.file()&&(HTMLPreview.previewform.innerHTML="<p>Loading...</p>",HTMLPreview.send(HTMLPreview.raw(),"loadHTML"))}};